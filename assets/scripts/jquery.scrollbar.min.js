/**
 * jQuery CSS Customizable Scrollbar
 *
 * Copyright 2013, Yuriy Khabarov
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * If you found bug, please contact me via email <13real008@gmail.com>
 *
 * @author Yuriy Khabarov aka Gromo
 * @version 0.1.6
 * @url https://github.com/gromo/dslib/tree/master/jquery.scrollbar
 */
(function(g,m,i){var h={mobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent),webkit:i.WebKitPoint?true:false,log:function(q,r){var p=q;if(r&&typeof q!="string"){p=[];g.each(q,function(t,s){p.push('"'+t+'": '+s);});p=p.join(", ");}if(i.console&&i.console.log){i.console.log(p);}},scroll:null};var b=false;var e=1,n="px";var j=[];var f={autoScrollSize:true,disableBodyScroll:false,duration:200,ignoreMobile:true,scrollStep:30,showArrows:true,type:"simple",scrollx:null,scrolly:null,onInit:null,onDestroy:null};var d=function(p,q){if(!h.scroll){h.scroll=o();/*h.log("Init jQuery CSS Customizable Scrollbar v0.1.5")*/;}this.container=p;this.options=g.extend({},f);this.scrollx={};this.scrolly={};this.init(q);};d.prototype={destroy:function(){if(!this.wrapper){return;}var q=this.container.scrollLeft();var p=this.container.scrollTop();this.container.insertBefore(this.wrapper).css({height:"",margin:""}).removeClass("scroll-content").removeClass("scroll-scrollx_show").removeClass("scroll-scrolly_show").off(".scrollbar").scrollLeft(q).scrollTop(p);this.scrollx.scrollbar.hide().find("div").andSelf().off(".scrollbar");this.scrolly.scrollbar.hide().find("div").andSelf().off(".scrollbar");this.wrapper.remove();g(m).add("body").off(".scrollbar");if(g.isFunction(this.options.onDestroy)){this.options.onDestroy.apply(this,[this.container]);}},getScrollbar:function(r){var s=this.options["scroll"+r];var p={advanced:'<div class="scroll-arrow scroll-arrow_less"></div><div class="scroll-arrow scroll-arrow_more"></div><div class="scroll-element_outer">    <div class="scroll-element_size"></div>    <div class="scroll-element_inner-wrapper">        <div class="scroll-element_inner">            <div class="scroll-element_inner-bottom"></div>        </div>    </div>    <div class="scroll-bar">        <div class="scroll-bar_body">            <div class="scroll-bar_body-inner"></div>        </div>        <div class="scroll-bar_bottom"></div>        <div class="scroll-bar_center"></div>    </div></div>',simple:'<div class="scroll-element_outer">    <div class="scroll-element_size"></div>    <div class="scroll-element_inner"></div>    <div class="scroll-bar"></div></div>'};var q=p[this.options.type]?this.options.type:"advanced";if(s){if(typeof(s)=="string"){s=g(s).appendTo(this.wrapper);}else{s=g(s);}}else{s=g("<div>").addClass("scroll-element").html(p[q]).appendTo(this.wrapper);}if(this.options.showArrows){s.addClass("scroll-element_show-arrows");}return s.addClass("scroll-"+r);},init:function(z){var r=this;var t=this.container;var p=g.extend(this.options,z);var y={x:this.scrollx,y:this.scrolly};var u=this.wrapper;var v={scrollLeft:t.scrollLeft(),scrollTop:t.scrollTop()};if(h.mobile&&p.ignoreMobile){return false;}if(!u){this.wrapper=u=t.wrap(g("<div>").css({position:(t.css("position")=="absolute")?"absolute":"relative"}).addClass("scroll-wrapper").addClass(t.attr("class"))).parent();t.addClass("scroll-content").css({height:"auto","margin-bottom":h.scroll.height*-1+n,"margin-right":h.scroll.width*-1+n}).on("scroll.scrollbar",function(){y.x.isVisible&&y.x.scroller.css("left",t.scrollLeft()*y.x.kx+n);y.y.isVisible&&y.y.scroller.css("top",t.scrollTop()*y.y.kx+n);});if(p.disableBodyScroll){var x=function(s){k(s)?y.y.isVisible&&y.y.mousewheel(s):y.x.isVisible&&y.x.mousewheel(s);};u.on({"MozMousePixelScroll.scrollbar":x,"mousewheel.scrollbar":x});if(h.mobile){u.on("touchstart.scrollbar",function(w){var B=w.originalEvent.touches&&w.originalEvent.touches[0]||w;var s={pageX:B.pageX,pageY:B.pageY};var A={left:t.scrollLeft(),top:t.scrollTop()};g(m).on({"touchmove.scrollbar":function(C){var D=C.originalEvent.targetTouches&&C.originalEvent.targetTouches[0]||C;t.scrollLeft(A.left+s.pageX-D.pageX);t.scrollTop(A.top+s.pageY-D.pageY);C.preventDefault();},"touchend.scrollbar":function(){g(m).off(".scrollbar");}});});}}}else{t.css({height:"auto"});}g.each(y,function(E,F){var A=null;var D=true;var w=(E=="x")?"scrollLeft":"scrollTop";var C=p.scrollStep;var s=function(){var G=t[w]();t[w](G+C);if(D==true&&(G+C)>=B){G=t[w]();}if(D==false&&(G+C)<=B){G=t[w]();}if(t[w]()==G&&A){A();}};var B=0;if(!F.scrollbar){F.scrollbar=r.getScrollbar(E);F.scroller=F.scrollbar.find(".scroll-bar");F.mousewheel=function(I){if(!F.isVisible||(E=="x"&&k(I))){return true;}if(E=="y"&&!k(I)){y.x.mousewheel(I);return true;}var J=I.originalEvent.wheelDelta*-1||I.originalEvent.detail;var H=F.size-F.visible-F.offset;if(!((B<=0&&J<0)||(B>=H&&J>0))){B=B+J;if(B<0){B=0;}if(B>H){B=H;}var G={};G[w]=B;t.stop().animate(G,240,"linear",function(){B=t[w]();});}I.preventDefault();return false;};F.scrollbar.on({"MozMousePixelScroll.scrollbar":F.mousewheel,"mousewheel.scrollbar":F.mousewheel,"mouseenter.scrollbar":function(){B=t[w]();}});F.scrollbar.find(".scroll-arrow, .scroll-element_inner").on("mousedown.scrollbar",function(I){if(I.which!=e){return true;}D=true;var H=F.size-F.visible-F.offset;if(g(this).hasClass("scroll-arrow")){D=g(this).hasClass("scroll-arrow_more");C=D?p.scrollStep:p.scrollStep*-1;B=D?H:0;}else{D=I[(E=="x")?"pageX":"pageY"]>F.scroller.offset()[(E=="x")?"left":"top"];C=D?F.visible:F.visible*-1;B=(I[(E=="x")?"pageX":"pageY"]-F.scroller.offset()[(E=="x")?"left":"top"]);if(D){B=B-F.scroller[(E=="x")?"width":"height"]();}B=t[w]()+(B/F.kx);}var J=0,K=0;A=function(){B=t[w]();clearInterval(K);clearTimeout(J);J=0;K=0;};J=setTimeout(function(){K=setInterval(s,40);},p.duration+100);var G={};G[w]=t[w]()+C;t.animate(G,p.duration);return a(A,I);});F.scroller.on("mousedown.scrollbar",function(H){if(H.which!=e){return true;}var G=H[(E=="x")?"pageX":"pageY"];var I=t[w]();F.scrollbar.addClass("scroll-draggable");g(m).on("mousemove.scrollbar",function(J){var K=parseInt((J[(E=="x")?"pageX":"pageY"]-G)/F.kx,10);t[w](I+(K));});return a(function(){F.scrollbar.removeClass("scroll-draggable");B=t[w]();},H);});}});g.each(y,function(A,B){var s="scroll-scroll"+A+"_show";var w=(A=="x")?y.y:y.x;B.scrollbar.hide();w.scrollbar.removeClass(s);t.removeClass(s);});g.each(y,function(s,w){g.extend(w,(s=="x")?{offset:parseInt(t.css("left"),10)||0,size:t.prop("scrollWidth"),visible:u.width()}:{offset:parseInt(t.css("top"),10)||0,size:t.prop("scrollHeight"),visible:u.height()});});var q=function(D,E){var A="scroll-scroll"+D+"_show";var C=(D=="x")?y.y:y.x;var B=parseInt(t.css((D=="x")?"left":"top"),10)||0;var w=E.size;var s=E.visible+B;E.isVisible=w>s;if(E.isVisible){E.scrollbar.show();C.scrollbar.addClass(A);t.addClass(A);}else{E.scrollbar.hide();C.scrollbar.removeClass(A);t.removeClass(A);}if(D=="y"){t.css("height",E.isVisible?(s+h.scroll.height)+n:"auto");}if(y.x.size!=t.prop("scrollWidth")||y.y.size!=t.prop("scrollHeight")||y.x.visible!=u.width()||y.y.visible!=u.height()||y.x.offset!=(parseInt(t.css("left"),10)||0)||y.y.offset!=(parseInt(t.css("top"),10)||0)){g.each(y,function(F,G){g.extend(G,(F=="x")?{offset:parseInt(t.css("left"),10)||0,size:t.prop("scrollWidth"),visible:u.width()}:{offset:parseInt(t.css("top"),10)||0,size:t.prop("scrollHeight"),visible:u.height()});});q(D=="x"?"y":"x",C);}};g.each(y,q);g.each(y,function(E,F){var B=(E=="x")?"left":"top";var w=(E=="x")?"width":"height";var D=parseInt(t.css(B),10)||0;var A=F.size;var s=F.visible+D;F.scrollbar.css(w,F.visible+n);var C=F.scrollbar.find(".scroll-element_size");C=C[w]()+parseInt(C.css(B)||0,10);if(p.autoScrollSize){F.scrollbarSize=parseInt(C*s/A,10);F.scroller.css(w,F.scrollbarSize+n);}F.scrollbarSize=parseInt(F.scroller.css(w),10);F.kx=((C-F.scrollbarSize)/(A-s))||1;});if(g.isFunction(p.onInit)){p.onInit.apply(this,[t]);}t.scrollLeft(v.scrollLeft).scrollTop(v.scrollTop).trigger("scroll");}};g.fn.scrollbar=function(q,p){var r=this;if(q=="get"){r=null;}this.each(function(){var t=g(this);if(t.hasClass("scroll-wrapper")||t.get(0).nodeName=="body"){return true;}var s=t.data("scrollbar");if(s){if(q==="get"){r=s;return false;}q=(typeof q=="string"&&s[q])?q:"init";s[q].apply(s,g.isArray(p)?p:[]);if(q=="destroy"){t.removeData("scrollbar");while(g.inArray(s,j)>=0){j.splice(g.inArray(s,j),1);}}}else{if(typeof q!="string"){s=new d(t,q);t.data("scrollbar",s);j.push(s);}}return true;});return r;};var l=0;var c=setInterval(function(){var r,v,t,q,p,u;for(r=0;r<j.length;r++){t=j[r];v=t.container;q=t.wrapper;p=t.scrollx;u=t.scrolly;if(q&&q.is(":visible")&&(v.prop("scrollWidth")!=p.size||v.prop("scrollHeight")!=u.size||q.width()!=p.visible||q.height()!=u.visible)){t.init();if(b){h.log({scrollHeight:v.prop("scrollHeight")+":"+t.scrolly.size,scrollWidth:v.prop("scrollWidth")+":"+t.scrollx.size,visibleHeight:q.height()+":"+t.scrolly.visible,visibleWidth:q.width()+":"+t.scrollx.visible},true);if(l++>100){h.log("Scroll udpates exceed 100");clearInterval(c);}}}}},300);function o(){var r={border:"none",height:"100px",margin:"0",padding:"0",width:"100px"};var p=g("<div>").css(g.extend({},r));var q=g("<div>").css(g.extend({background:"#F00",left:"-200px",overflow:"scroll",position:"absolute",top:"-200px"},r)).append(p).appendTo("body").scrollLeft(p.width()).scrollTop(p.height());var s={height:(q.offset().top-p.offset().top)||0,width:(q.offset().left-p.offset().left)||0};if(h.webkit){s.height=0;s.width=0;}q.remove();return s;}function a(q,p){g(m).on({"blur.scrollbar":function(){g(m).add("body").off(".scrollbar");q();},"dragstart.scrollbar":function(r){r.preventDefault();return false;},"mouseup.scrollbar":function(){g(m).add("body").off(".scrollbar");q();}});g("body").on({"selectstart.scrollbar":function(r){r.preventDefault();return false;}});p&&p.preventDefault();return false;}function k(p){var q=p.originalEvent;if(q.axis&&q.axis===q.HORIZONTAL_AXIS){return false;}if(q.wheelDeltaX){return false;}return true;}})(jQuery,document,window);